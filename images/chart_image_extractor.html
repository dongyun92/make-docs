<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML 차트 이미지 일괄 추출기</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .chart-item {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            background: #fafafa;
        }
        .chart-item h3 {
            margin: 0 0 15px 0;
            color: #555;
        }
        .chart-frame {
            width: 100%;
            height: 400px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .extract-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        .extract-btn:hover {
            background: #218838;
        }
        .extract-all-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            display: block;
            margin: 20px auto;
        }
        .extract-all-btn:hover {
            background: #0056b3;
        }
        .progress {
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>🎯 RWSL 차트 이미지 일괄 추출기</h1>
        
        <div class="chart-grid">

            <div class="chart-item">
                <h3>1. Trl Roadmap</h3>
                <iframe id="chart_1" class="chart-frame" src="trl_roadmap.html"></iframe>
                <button class="extract-btn" onclick="extractChart(1, 'trl_roadmap.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>2. Rwsl Annual Investment Plan</h3>
                <iframe id="chart_2" class="chart-frame" src="rwsl_annual_investment_plan.html"></iframe>
                <button class="extract-btn" onclick="extractChart(2, 'rwsl_annual_investment_plan.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>3. Budget Trend</h3>
                <iframe id="chart_3" class="chart-frame" src="budget_trend.html"></iframe>
                <button class="extract-btn" onclick="extractChart(3, 'budget_trend.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>4. Chart Test Project Sample 1</h3>
                <iframe id="chart_4" class="chart-frame" src="chart_test_project_sample_1.html"></iframe>
                <button class="extract-btn" onclick="extractChart(4, 'chart_test_project_sample_1.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>5. Attack Drone Chart 1</h3>
                <iframe id="chart_5" class="chart-frame" src="attack_drone_chart_1.html"></iframe>
                <button class="extract-btn" onclick="extractChart(5, 'attack_drone_chart_1.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>6. Chart Attack Drone Defense System 4</h3>
                <iframe id="chart_6" class="chart-frame" src="chart_attack_drone_defense_system_4.html"></iframe>
                <button class="extract-btn" onclick="extractChart(6, 'chart_attack_drone_defense_system_4.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>7. Rwsl Investment Allocation Chart</h3>
                <iframe id="chart_7" class="chart-frame" src="rwsl_investment_allocation_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(7, 'rwsl_investment_allocation_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>8. Rwsl Domestic Demand Chart</h3>
                <iframe id="chart_8" class="chart-frame" src="rwsl_domestic_demand_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(8, 'rwsl_domestic_demand_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>9. Auto Chart 6</h3>
                <iframe id="chart_9" class="chart-frame" src="auto_chart_6.html"></iframe>
                <button class="extract-btn" onclick="extractChart(9, 'auto_chart_6.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>10. Chart Attack Drone Defense System 5</h3>
                <iframe id="chart_10" class="chart-frame" src="chart_attack_drone_defense_system_5.html"></iframe>
                <button class="extract-btn" onclick="extractChart(10, 'chart_attack_drone_defense_system_5.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>11. Rwsl Platform Architecture</h3>
                <iframe id="chart_11" class="chart-frame" src="rwsl_platform_architecture.html"></iframe>
                <button class="extract-btn" onclick="extractChart(11, 'rwsl_platform_architecture.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>12. Rwsl System Architecture</h3>
                <iframe id="chart_12" class="chart-frame" src="rwsl_system_architecture.html"></iframe>
                <button class="extract-btn" onclick="extractChart(12, 'rwsl_system_architecture.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>13. Market Growth Regional</h3>
                <iframe id="chart_13" class="chart-frame" src="market_growth_regional.html"></iframe>
                <button class="extract-btn" onclick="extractChart(13, 'market_growth_regional.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>14. Chart Attack Drone Defense System 2</h3>
                <iframe id="chart_14" class="chart-frame" src="chart_attack_drone_defense_system_2.html"></iframe>
                <button class="extract-btn" onclick="extractChart(14, 'chart_attack_drone_defense_system_2.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>15. Auto Chart 1</h3>
                <iframe id="chart_15" class="chart-frame" src="auto_chart_1.html"></iframe>
                <button class="extract-btn" onclick="extractChart(15, 'auto_chart_1.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>16. Market Growth Line</h3>
                <iframe id="chart_16" class="chart-frame" src="market_growth_line.html"></iframe>
                <button class="extract-btn" onclick="extractChart(16, 'market_growth_line.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>17. Rwsl Tech Spillover Chart</h3>
                <iframe id="chart_17" class="chart-frame" src="rwsl_tech_spillover_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(17, 'rwsl_tech_spillover_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>18. Rwsl Employment Effect Chart</h3>
                <iframe id="chart_18" class="chart-frame" src="rwsl_employment_effect_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(18, 'rwsl_employment_effect_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>19. Rwsl Future Aviation Integration</h3>
                <iframe id="chart_19" class="chart-frame" src="rwsl_future_aviation_integration.html"></iframe>
                <button class="extract-btn" onclick="extractChart(19, 'rwsl_future_aviation_integration.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>20. Rwsl Technology Gap Analysis</h3>
                <iframe id="chart_20" class="chart-frame" src="rwsl_technology_gap_analysis.html"></iframe>
                <button class="extract-btn" onclick="extractChart(20, 'rwsl_technology_gap_analysis.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>21. Budget Distribution</h3>
                <iframe id="chart_21" class="chart-frame" src="budget_distribution.html"></iframe>
                <button class="extract-btn" onclick="extractChart(21, 'budget_distribution.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>22. Chart Attack Drone Defense System 3</h3>
                <iframe id="chart_22" class="chart-frame" src="chart_attack_drone_defense_system_3.html"></iframe>
                <button class="extract-btn" onclick="extractChart(22, 'chart_attack_drone_defense_system_3.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>23. Rwsl Funding Structure Chart</h3>
                <iframe id="chart_23" class="chart-frame" src="rwsl_funding_structure_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(23, 'rwsl_funding_structure_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>24. Auto Chart 3</h3>
                <iframe id="chart_24" class="chart-frame" src="auto_chart_3.html"></iframe>
                <button class="extract-btn" onclick="extractChart(24, 'auto_chart_3.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>25. Attack Drone Chart 5</h3>
                <iframe id="chart_25" class="chart-frame" src="attack_drone_chart_5.html"></iframe>
                <button class="extract-btn" onclick="extractChart(25, 'attack_drone_chart_5.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>26. Rwsl Traffic Growth Chart</h3>
                <iframe id="chart_26" class="chart-frame" src="rwsl_traffic_growth_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(26, 'rwsl_traffic_growth_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>27. Chart Test Project Sample 5</h3>
                <iframe id="chart_27" class="chart-frame" src="chart_test_project_sample_5.html"></iframe>
                <button class="extract-btn" onclick="extractChart(27, 'chart_test_project_sample_5.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>28. Rwsl Economic Benefit Chart</h3>
                <iframe id="chart_28" class="chart-frame" src="rwsl_economic_benefit_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(28, 'rwsl_economic_benefit_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>29. Budget Pie</h3>
                <iframe id="chart_29" class="chart-frame" src="budget_pie.html"></iframe>
                <button class="extract-btn" onclick="extractChart(29, 'budget_pie.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>30. Rwsl Phase1 Plan Chart</h3>
                <iframe id="chart_30" class="chart-frame" src="rwsl_phase1_plan_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(30, 'rwsl_phase1_plan_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>31. Rwsl Accident Analysis Chart</h3>
                <iframe id="chart_31" class="chart-frame" src="rwsl_accident_analysis_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(31, 'rwsl_accident_analysis_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>32. Config Chart 6</h3>
                <iframe id="chart_32" class="chart-frame" src="config_chart_6.html"></iframe>
                <button class="extract-btn" onclick="extractChart(32, 'config_chart_6.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>33. Rwsl Market Forecast Chart</h3>
                <iframe id="chart_33" class="chart-frame" src="rwsl_market_forecast_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(33, 'rwsl_market_forecast_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>34. Chart Test Project Sample 4</h3>
                <iframe id="chart_34" class="chart-frame" src="chart_test_project_sample_4.html"></iframe>
                <button class="extract-btn" onclick="extractChart(34, 'chart_test_project_sample_4.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>35. Attack Drone Chart 4</h3>
                <iframe id="chart_35" class="chart-frame" src="attack_drone_chart_4.html"></iframe>
                <button class="extract-btn" onclick="extractChart(35, 'attack_drone_chart_4.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>36. Chart Attack Drone Defense System 1</h3>
                <iframe id="chart_36" class="chart-frame" src="chart_attack_drone_defense_system_1.html"></iframe>
                <button class="extract-btn" onclick="extractChart(36, 'chart_attack_drone_defense_system_1.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>37. Auto Chart 2</h3>
                <iframe id="chart_37" class="chart-frame" src="auto_chart_2.html"></iframe>
                <button class="extract-btn" onclick="extractChart(37, 'auto_chart_2.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>38. Rwsl Global Adoption Chart</h3>
                <iframe id="chart_38" class="chart-frame" src="rwsl_global_adoption_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(38, 'rwsl_global_adoption_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>39. Organization Chart</h3>
                <iframe id="chart_39" class="chart-frame" src="organization_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(39, 'organization_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>40. Market Growth Trends</h3>
                <iframe id="chart_40" class="chart-frame" src="market_growth_trends.html"></iframe>
                <button class="extract-btn" onclick="extractChart(40, 'market_growth_trends.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>41. Chart Test Project Sample 3</h3>
                <iframe id="chart_41" class="chart-frame" src="chart_test_project_sample_3.html"></iframe>
                <button class="extract-btn" onclick="extractChart(41, 'chart_test_project_sample_3.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>42. Rwsl Payback Analysis Chart</h3>
                <iframe id="chart_42" class="chart-frame" src="rwsl_payback_analysis_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(42, 'rwsl_payback_analysis_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>43. Swot Analysis</h3>
                <iframe id="chart_43" class="chart-frame" src="swot_analysis.html"></iframe>
                <button class="extract-btn" onclick="extractChart(43, 'swot_analysis.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>44. Rwsl Project Roadmap Chart</h3>
                <iframe id="chart_44" class="chart-frame" src="rwsl_project_roadmap_chart.html"></iframe>
                <button class="extract-btn" onclick="extractChart(44, 'rwsl_project_roadmap_chart.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>45. Gantt Schedule</h3>
                <iframe id="chart_45" class="chart-frame" src="gantt_schedule.html"></iframe>
                <button class="extract-btn" onclick="extractChart(45, 'gantt_schedule.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>46. Auto Chart 5</h3>
                <iframe id="chart_46" class="chart-frame" src="auto_chart_5.html"></iframe>
                <button class="extract-btn" onclick="extractChart(46, 'auto_chart_5.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>47. System Architecture</h3>
                <iframe id="chart_47" class="chart-frame" src="system_architecture.html"></iframe>
                <button class="extract-btn" onclick="extractChart(47, 'system_architecture.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>48. Attack Drone Chart 3</h3>
                <iframe id="chart_48" class="chart-frame" src="attack_drone_chart_3.html"></iframe>
                <button class="extract-btn" onclick="extractChart(48, 'attack_drone_chart_3.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>49. Attack Drone Chart 2</h3>
                <iframe id="chart_49" class="chart-frame" src="attack_drone_chart_2.html"></iframe>
                <button class="extract-btn" onclick="extractChart(49, 'attack_drone_chart_2.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>50. Auto Chart 4</h3>
                <iframe id="chart_50" class="chart-frame" src="auto_chart_4.html"></iframe>
                <button class="extract-btn" onclick="extractChart(50, 'auto_chart_4.html')">이미지 추출</button>
            </div>

            <div class="chart-item">
                <h3>51. Chart Test Project Sample 2</h3>
                <iframe id="chart_51" class="chart-frame" src="chart_test_project_sample_2.html"></iframe>
                <button class="extract-btn" onclick="extractChart(51, 'chart_test_project_sample_2.html')">이미지 추출</button>
            </div>

        </div>
        
        <button class="extract-all-btn" onclick="extractAllCharts()">🎯 모든 차트 이미지 일괄 추출</button>
        
        <div class="progress" id="progress"></div>
    </div>
    
    <script>
        let extractedCount = 0;
        const totalCharts = 51;
        
        function extractChart(index, filename) {
            const iframe = document.getElementById('chart_' + index);
            
            // iframe 내용을 캡처하는 것은 보안상 제한이 있으므로
            // 새 창에서 해당 HTML을 열어서 추출하도록 안내
            const newWindow = window.open(filename, '_blank', 'width=900,height=600');
            
            // 새 창이 로드되면 자동으로 이미지 추출 시작
            newWindow.onload = function() {
                setTimeout(() => {
                    newWindow.html2canvas(newWindow.document.body, {
                        useCORS: true,
                        allowTaint: true,
                        scale: 2,
                        backgroundColor: '#ffffff'
                    }).then(canvas => {
                        const imgData = canvas.toDataURL('image/png');
                        const downloadLink = newWindow.document.createElement('a');
                        downloadLink.href = imgData;
                        downloadLink.download = filename.replace('.html', '.png');
                        downloadLink.click();
                        
                        newWindow.close();
                        extractedCount++;
                        updateProgress();
                    });
                }, 2000);
            };
        }
        
        function extractAllCharts() {
            extractedCount = 0;
            updateProgress();
            
            const htmlFiles = ["trl_roadmap.html", "rwsl_annual_investment_plan.html", "budget_trend.html", "chart_test_project_sample_1.html", "attack_drone_chart_1.html", "chart_attack_drone_defense_system_4.html", "rwsl_investment_allocation_chart.html", "rwsl_domestic_demand_chart.html", "auto_chart_6.html", "chart_attack_drone_defense_system_5.html", "rwsl_platform_architecture.html", "rwsl_system_architecture.html", "market_growth_regional.html", "chart_attack_drone_defense_system_2.html", "auto_chart_1.html", "market_growth_line.html", "rwsl_tech_spillover_chart.html", "rwsl_employment_effect_chart.html", "rwsl_future_aviation_integration.html", "rwsl_technology_gap_analysis.html", "budget_distribution.html", "chart_attack_drone_defense_system_3.html", "rwsl_funding_structure_chart.html", "auto_chart_3.html", "attack_drone_chart_5.html", "rwsl_traffic_growth_chart.html", "chart_test_project_sample_5.html", "rwsl_economic_benefit_chart.html", "budget_pie.html", "rwsl_phase1_plan_chart.html", "rwsl_accident_analysis_chart.html", "config_chart_6.html", "rwsl_market_forecast_chart.html", "chart_test_project_sample_4.html", "attack_drone_chart_4.html", "chart_attack_drone_defense_system_1.html", "auto_chart_2.html", "rwsl_global_adoption_chart.html", "organization_chart.html", "market_growth_trends.html", "chart_test_project_sample_3.html", "rwsl_payback_analysis_chart.html", "swot_analysis.html", "rwsl_project_roadmap_chart.html", "gantt_schedule.html", "auto_chart_5.html", "system_architecture.html", "attack_drone_chart_3.html", "attack_drone_chart_2.html", "auto_chart_4.html", "chart_test_project_sample_2.html"];
            
            htmlFiles.forEach((filename, index) => {
                setTimeout(() => {
                    extractChart(index + 1, filename);
                }, index * 3000); // 3초 간격으로 순차 추출
            });
        }
        
        function updateProgress() {
            const progress = document.getElementById('progress');
            progress.textContent = `추출 진행률: ${extractedCount}/${totalCharts} (${Math.round(extractedCount/totalCharts*100)}%)`;
        }
    </script>
</body>
</html>