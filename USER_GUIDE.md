# 사업계획서 자동 차트 생성 시스템 사용자 가이드

## 📋 시스템 개요

이 시스템은 **프롬프트 템플릿 기반**으로 사업계획서에 최적화된 차트를 생성하는 새로운 방식을 지원합니다.

### 🔄 새로운 워크플로우

1. **사업계획서 MD 파일 작성**
2. **프롬프트 템플릿을 사용하여 Claude에게 HTML 차트 생성 요청**
3. **생성된 HTML 파일들을 GUI에 업로드**
4. **자동 PNG 변환 및 문서 생성**

## 🎯 프롬프트 템플릿 사용법

### 1. 시장 분석 차트

#### 성장률 차트 요청
```
다음 조건에 맞는 시장 성장률 차트 HTML을 생성해주세요:

**주제**: [여기에 사업 주제 입력 - 예: "재래식 무기 탑재 공격드론 방어시스템"]
**차트 타입**: 선 그래프 (Line Chart)
**데이터 요구사항**:
- 최근 5년간 시장 성장률 (2019-2023)
- 실제 업계 트렌드에 맞는 현실적인 수치
- Y축 최대값은 데이터 최대값의 1.2배로 설정

**스타일 요구사항**:
- 한글 폰트 지원 ('Malgun Gothic', 'Arial', sans-serif)
- 차트 크기: 900x600px
- 제목 없이 순수 차트만
- 범례는 한글로 표시
- 격자선 표시

**출력 형식**: 완전한 HTML 파일 (<!DOCTYPE html>로 시작)
```

#### 시장 규모 차트 요청
```
다음 조건에 맞는 시장 규모 차트 HTML을 생성해주세요:

**주제**: [여기에 사업 주제 입력]
**차트 타입**: 막대 그래프 (Bar Chart)
**데이터 요구사항**:
- 지역별 시장 규모 (국내/해외 비교)
- 단위: 억원 또는 조원
- 현실적인 시장 규모 데이터

**스타일 요구사항**:
- 한글 폰트 지원
- 차트 크기: 900x600px
- Y축은 데이터에 적합한 스케일링
- 색상: 블루 계열

**출력 형식**: 완전한 HTML 파일
```

### 2. 재무 분석 차트

#### 예산 배분 차트 요청
```
다음 조건에 맞는 예산 배분 차트 HTML을 생성해주세요:

**주제**: [여기에 사업 주제 입력]
**차트 타입**: 파이 차트 (Pie Chart)
**데이터 요구사항**:
- R&D, 마케팅, 운영비, 인건비, 기타 항목
- 각 항목별 현실적인 비율
- 총 예산 규모에 맞는 분배

**스타일 요구사항**:
- 각 섹션별 다른 색상
- 퍼센트 라벨 표시
- 차트 크기: 700x700px

**출력 형식**: 완전한 HTML 파일
```

### 3. 기술 분석 차트

#### 기술 수준 비교 차트 요청
```
다음 조건에 맞는 기술 수준 비교 차트 HTML을 생성해주세요:

**주제**: [여기에 사업 주제 입력]
**차트 타입**: 그룹화된 막대 그래프
**데이터 요구사항**:
- 핵심 기술 영역별 국내/해외 수준 비교
- 기술성숙도 1-10 스케일
- 5-7개 기술 영역

**스타일 요구사항**:
- 국내: 파란색, 해외: 빨간색
- Y축 최대값: 10
- 범례 표시

**출력 형식**: 완전한 HTML 파일
```

### 4. 위험 분석 차트

#### 위험 매트릭스 차트 요청
```
다음 조건에 맞는 위험 매트릭스 차트 HTML을 생성해주세요:

**주제**: [여기에 사업 주제 입력]
**차트 타입**: 산점도 (Scatter Plot)
**데이터 요구사항**:
- X축: 발생 가능성 (1-5)
- Y축: 영향도 (1-5)
- 주요 위험 요소 5-8개

**스타일 요구사항**:
- 위험도별 색상 구분
- 각 점에 위험 요소명 라벨
- 배경에 위험도 구역 표시

**출력 형식**: 완전한 HTML 파일
```

## 🖥️ GUI 사용법

### 1. 기본 사용 (HTML 파일 없이)
1. MD 파일 선택
2. 출력 폴더 선택
3. **변환 시작** 클릭
4. → 레거시 차트 시스템으로 기본 차트 자동 생성

### 2. 새로운 방식 (HTML 파일 포함)
1. MD 파일 선택
2. **HTML 파일들 선택** 버튼 클릭하여 생성된 HTML 차트들 추가
3. 출력 폴더 선택
4. **변환 시작** 클릭
5. → HTML → PNG 자동 변환 → 스마트 배치 → DOCX 생성

### 3. HTML 파일 관리
- **HTML 파일들 선택**: 여러 HTML 파일 동시 선택 가능
- **선택 파일 제거**: 리스트에서 개별 파일 제거 가능
- **파일 목록**: 선택된 파일들을 리스트로 표시
- **파일 개수**: 현재 선택된 파일 개수 표시

## 📂 파일 구조

```
make-docs/
├── gui_converter.py           # 향상된 GUI (HTML 다중 선택 지원)
├── prompt_templates.py        # 프롬프트 템플릿 시스템
├── chart_placement_rules.py   # 차트 배치 규칙 엔진
├── enhanced_converter.py      # HTML 기반 변환기
├── simple_thermal_converter.py # 기존 변환기 (레거시)
├── images/                    # PNG 파일 저장 폴더
│   ├── *.html                # 생성된 HTML 차트들
│   └── *.png                 # 변환된 PNG 이미지들
└── output/                    # 최종 DOCX 파일들
```

## 🚀 사용 시나리오

### 시나리오 1: 기존 방식 (호환성)
```
MD 파일만 → GUI → 기본 차트 자동 생성 → DOCX
```

### 시나리오 2: 새로운 방식 (권장)
```
1. MD 파일 작성
2. 프롬프트 템플릿으로 Claude에게 HTML 차트 생성 요청
3. 생성된 HTML 파일들을 다운로드
4. GUI에서 MD + HTML 파일들 선택
5. 자동 변환 → 의미있는 차트가 포함된 DOCX
```

## ⚠️ 주의사항

### HTML 파일 요구사항
- **완전한 HTML 파일**: `<!DOCTYPE html>`로 시작해야 함
- **한글 폰트**: `'Malgun Gothic', 'Arial', sans-serif` 지원
- **순수 차트**: 제목 없이 차트만 포함
- **적절한 크기**: 900x600px 권장 (파이차트는 700x700px)

### 데이터 품질
- **현실적인 데이터**: 실제 업계 트렌드 반영
- **적절한 스케일**: Y축이 데이터에 맞게 조정
- **의미있는 비교**: 섹션 내용과 일치하는 차트

### 파일 관리
- HTML 파일명이 PNG 파일명의 기준이 됨
- `images/` 폴더에 자동 저장
- 기존 파일과 중복 시 덮어쓰기

## 🔧 문제 해결

### Chrome 캡처 오류
```
⚠️ Chrome이 없어 HTML 캡처를 건너뜁니다.
```
- Chrome 브라우저 설치 확인
- macOS: `/Applications/Google Chrome.app/Contents/MacOS/Google Chrome`

### HTML 파일 오류
```
⚠️ [파일명] 캡처 실패
```
- HTML 파일이 완전한 형식인지 확인
- 브라우저에서 정상 표시되는지 테스트

### PNG 파일 누락
```
⚠️ 다음 PNG 파일들이 누락되었습니다:
```
- HTML 파일들이 먼저 캡처되었는지 확인
- `images/` 폴더 권한 확인

## 💡 팁

1. **섹션별 차트 매칭**: MD 파일의 섹션 제목과 차트가 의미적으로 연결되도록 작성
2. **파일명 규칙**: HTML 파일명에 차트 타입을 포함하면 자동 인식 향상
3. **일괄 처리**: 여러 HTML 파일을 한 번에 선택하여 효율성 증대
4. **프롬프트 재사용**: 템플릿을 복사하여 다른 사업 주제에 재활용

## 🆕 향후 확장 계획

- **AI 자동 차트 생성**: MD 내용 분석 후 자동 HTML 생성
- **차트 스타일 커스터마이징**: 색상, 폰트, 크기 템플릿 확장
- **실시간 미리보기**: GUI에서 차트 미리보기 기능
- **배치 규칙 사용자화**: 사용자 정의 배치 규칙 지원